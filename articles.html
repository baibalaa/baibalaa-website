<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baibalaa Insights</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google AdSense Code -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8120686861734870"
     crossorigin="anonymous"></script>
</head>
<body>

    <nav>
        <ul>
            <li><a href="index.html">HOME</a></li>
            <li><a href="articles.html">BAIBALAA INSIGHTS</a></li>
            <li><a href="tournaments.html">TOURNAMENTS</a></li>
            <li><a href="champions.html">CHAMPIONS</a></li>
            <li><a href="mrbaibalaa.html">MR. BAIBALAA</a></li>
            <li><a href="highlights.html">HIGHLIGHTS</a></li>
        </ul>
    </nav>

    <header>
        <h1>BAIBALAA INSIGHTS</h1>
    </header>

    <section id="articles">
        <article id="article-1">
            <h2>This Year's Baibalaa Tournament to be Held During Eid Holidays</h2>
            <img src="https://i.imgur.com/FVn1DMS.png" alt="Baibalaa Tournament 2025">
            <p><strong>Published on:</strong> 17th March 2025, 13:45</p>
            <p class="justified">
                The much-awaited Baibalaa Tournament is returning this year, and it’s going to be bigger than ever! 
                Scheduled to take place during the Eid holidays starting from April 1st, this tournament promises to deliver an exciting blend 
                of competitive gameplay, team spirit, and festive celebrations.
            </p>
            <!-- Comment Section for Article 1 -->
            <section id="comment-section-1" class="comment-section">
                <h2>Leave a Comment</h2>
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <input type="text" id="visitor-name-1" maxlength="25" placeholder="Your Name"
                        style="width: 50%; padding: 8px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;" />
                    <textarea id="comment-box-1" rows="4" cols="50" maxlength="150" placeholder="Write your comment here..."
                        style="width: 50%; padding: 8px; border: 1px solid #ccc; border-radius: 5px; font-size: 14px;"></textarea>
                    <br>
                    <button id="submit-comment-btn-1" 
                        style="padding: 10px 20px; background-color: #007BFF; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px;">
                        Submit Comment
                    </button>
                </div>
            </section>
            <!-- Comments Display for Article 1 -->
            <section id="comments-display-1" class="comments-display">
                <h2>Comments</h2>
                <div id="comments-list-1" class="comments-list">
                    <!-- Comments will be dynamically added here -->
                </div>
            </section>
        </article>
    </section>
    
    <footer>
        <div class="footer-container">
            <div class="footer-section">
                <h3>About Baibalaa MV</h3>
                <p>Baibalaa MV is dedicated to preserving and celebrating the history of Baibalaa, the pride of the Maldives.</p>
            </div>
        </div>
    </footer>

    <!-- Firebase SDK (CDN) -->
    <script type="module">
        // Import Firebase SDK for Realtime Database
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
        import { getDatabase, ref, push, set, get, child } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-database.js";
    
        // Firebase configuration
        const firebaseConfig = {
    apiKey: import.meta.env.VITE_FIREBASE_API_KEY, // ✅ Use the environment variable
    authDomain: "baibalaa-comments.firebaseapp.com",
    databaseURL: "https://baibalaa-comments-default-rtdb.firebaseio.com", 
    projectId: "baibalaa-comments",
    storageBucket: "baibalaa-comments.appspot.com",
    messagingSenderId: "1033627188071",
    appId: "1:1033627188071:web:8e2f7ed4d5ae95b066cdc2"
};

    
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // Function to submit the comment for a specific article
        function submitComment(articleId) {
            const visitorName = document.getElementById(`visitor-name-${articleId}`).value.trim();
            const commentText = document.getElementById(`comment-box-${articleId}`).value.trim();
    
            if (visitorName !== "" && commentText !== "") {
                try {
                    const commentsRef = ref(db, `comments/${articleId}`);
                    const newCommentRef = push(commentsRef);
                    set(newCommentRef, {
                        name: visitorName,
                        text: commentText,
                        timestamp: new Date().toISOString()
                    }).then(() => {
                        alert("Comment added successfully!");
                        document.getElementById(`visitor-name-${articleId}`).value = "";
                        document.getElementById(`comment-box-${articleId}`).value = "";
                        displayComments(articleId); 
                    }).catch((error) => {
                        console.error("Error adding comment: ", error);
                        alert("Error adding comment. Please try again.");
                    });
                } catch (e) {
                    console.error("Error adding comment: ", e);
                    alert("Error adding comment. Please try again.");
                }
            } else {
                alert("Please enter both your name and a comment.");
            }
        }

        // Function to display comments for a specific article
        function displayComments(articleId) {
            const commentsRef = ref(db, `comments/${articleId}`);
            get(commentsRef).then((snapshot) => {
                const commentsList = document.getElementById(`comments-list-${articleId}`);
                if (snapshot.exists()) {
                    commentsList.innerHTML = "";
                    snapshot.forEach((childSnapshot) => {
                        const comment = childSnapshot.val();
                        const commentElement = document.createElement("div");
                        commentElement.classList.add("comment");
                        commentElement.innerHTML = `
                            <p><strong>${comment.name}</strong>:</p>
                            <p>${comment.text}</p>
                            <p><strong>Posted on:</strong> ${new Date(comment.timestamp).toLocaleString()}</p>
                        `;
                        commentsList.appendChild(commentElement);
                    });
                } else {
                    commentsList.innerHTML = "<p>No comments yet.</p>";
                }
            }).catch((error) => {
                console.error("Error fetching comments: ", error);
            });
        }

        // Add event listeners for submit buttons
        document.getElementById("submit-comment-btn-1").addEventListener("click", () => submitComment(1));
        document.getElementById("submit-comment-btn-2").addEventListener("click", () => submitComment(2));
        document.getElementById("submit-comment-btn-3").addEventListener("click", () => submitComment(3));
        document.getElementById("submit-comment-btn-4").addEventListener("click", () => submitComment(4));

        // Load comments on page load for each article
        window.onload = () => {
            displayComments(1);
            displayComments(2);
            displayComments(3);
            displayComments(4);
        };
    </script>
    
</body>
</html>
